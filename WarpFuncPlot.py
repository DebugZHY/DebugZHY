import matplotlib.pyplot as plt
import numpy as np

edge = np.array([[0, 0, -6752.022402],
                 [0, 10, - 5350.984929],
                 [0, 20, - 4002.91875],
                 [0, 30, - 2662.416715],
                 [0, 40, - 1327.195745],
                 [0, 50, 0.442511025],
                 [0, 60, 1322.871788],
                 [0, 70, 2661.356244],
                 [0, 80, 4001.614476],
                 [0, 90, 5351.26444],
                 [0, 100, 6747.305302],
                 [-8, 100, 7080.616479],
                 [-16, 100, 7411.571867],
                 [-16, 91, 6116.06569],
                 [-16, 82, 4777.063631],
                 [-16, 73, 3427.843599],
                 [-16, 64, 2073.997523],
                 [-16, 55, 707.6490627],
                 [-25.92592593, 55, 620.7224809],
                 [-35.85185185, 55, 571.0232681],
                 [-45.77777778, 55, 521.3935087],
                 [-55.7037037, 55, 471.7638788],
                 [-65.62962963, 55, 422.1342492],
                 [-75.55555556, 55, 372.5046196],
                 [-85.48148148, 55, 322.8749899],
                 [-95.40740741, 55, 273.2453603],
                 [-105.3333333, 55, 223.6157307],
                 [-115.2592593, 55, 173.986101],
                 [-125.1851852, 55, 124.3564714],
                 [-135.1111111, 55, 74.72684178],
                 [-145.037037, 55, 25.09721215],
                 [-154.962963, 55, - 24.53241748],
                 [-164.8888889, 55, - 74.16204711],
                 [-174.8148148, 55, - 123.7916767],
                 [-184.7407407, 55, - 173.4213064],
                 [-194.6666667, 55, - 223.050936],
                 [-204.5925926, 55, - 272.6805656],
                 [-214.5185185, 55, - 322.3101953],
                 [-224.4444444, 55, - 371.9398249],
                 [-234.3703704, 55, - 421.5694545],
                 [-244.2962963, 55, - 471.1990841],
                 [-254.2222222, 55, - 520.828714],
                 [-264.1481481, 55, - 570.4584735],
                 [-274.0740741, 55, - 620.1576862],
                 [-284, 55, -707.084268],
                 [-284, 64, - 2079.090227],
                 [-284, 73, - 3429.120176],
                 [-284, 82, - 4778.036527],
                 [-284, 91, - 6118.54078],
                 [-284, 100, -7411.630187],
                 [-292, 100, - 7080.409858],
                 [-300, 100, -6752.022402],
                 [-300, 90, - 5350.984929],
                 [-300, 80, - 4002.91875],
                 [-300, 70, - 2662.416715],
                 [-300, 60, - 1327.195745],
                 [-300, 50, 0.442511014],
                 [-300, 40, 1322.871788],
                 [-300, 30, 2661.356244],
                 [-300, 20, 4001.614476],
                 [-300, 10, 5351.26444],
                 [-300, 0, 6747.305302],
                 [-292, 0, 7080.616479],
                 [-284, 0, 7411.571867],
                 [-284, 9, 6116.06569],
                 [-284, 18, 4777.063631],
                 [-284, 27, 3427.843599],
                 [-284, 36, 2073.997523],
                 [-284, 45, 707.6490627],
                 [-274.0740741, 45, 620.7224809],
                 [-264.1481481, 45, 571.0232681],
                 [-254.2222222, 45, 521.3935087],
                 [-244.2962963, 45, 471.7638788],
                 [-234.3703704, 45, 422.1342492],
                 [-224.4444444, 45, 372.5046196],
                 [-214.5185185, 45, 322.8749899],
                 [-204.5925926, 45, 273.2453603],
                 [-194.6666667, 45, 223.6157307],
                 [-184.7407407, 45, 173.986101],
                 [-174.8148148, 45, 124.3564714],
                 [-164.8888889, 45, 74.72684178],
                 [-154.962963, 45, 25.09721215],
                 [-145.037037, 45, - 24.53241748],
                 [-145.037037, 45, - 24.53241748],
                 [-135.1111111, 45, - 74.16204711],
                 [-125.1851852, 45, - 123.7916767],
                 [-115.2592593, 45, - 173.4213064],
                 [-105.3333333, 45, - 223.050936],
                 [-95.40740741, 45, - 272.6805656],
                 [-85.48148148, 45, - 322.3101953],
                 [-75.55555556, 45, - 371.9398249],
                 [-65.62962963, 45, - 421.5694545],
                 [-55.7037037, 45, - 471.1990841],
                 [-45.77777778, 45, - 520.828714],
                 [-35.85185185, 45, - 570.4584735],
                 [-25.92592593, 45, - 620.1576862],
                 [-16, 45, - 707.084268],
                 [-16, 36, - 2079.090227],
                 [-16, 27, - 3429.120176],
                 [-16, 18, - 4778.036527],
                 [-16, 9, - 6118.54078],
                 [-16, 0, - 7411.630187],
                 [-8, 0, - 7080.409858],
                 [0, 0, -6752.022402]])

data = np.array([[-8, 100, 7080.616479],
                 [-8, 75, 3540.3],
                 [-8, 25, -3540.3],
                 [-8, 0, - 7080.409858],
                 [-8, 0, - 7080.409858],
                 [-292, 100, -7080.409858],
                 [-292, 75, -3540.3],
                 [-292, 25, 3540.3],
                 [-292, 0, 7080.616479]])

sect = np.array([[0, 0, 0],
                 [0, 100, 0],
                 [-16, 100, 0],
                 [-16, 55, 0],
                 [-284, 55, 0],
                 [-284, 100, 0],
                 [-300, 100, 0],
                 [-300, 0, 0],
                 [-284, 0, 0],
                 [-284, 45, 0],
                 [-16, 45, 0],
                 [-16, 0, 0],
                 [0, 0, 0]])

line = np.array([[-8, 100, 7080.616479],
                 [-8, 100, 0],
                 [-8, 0, -7080.409858],
                 [-8, 0, 0],
                 [-8, 75, 3540.3],
                 [-8, 75, 0],
                 [-8, 25, -3540.3],
                 [-8, 25, 0],
                 [-8, 100, 7080.616479],
                 [-8, 0, -7080.409858],
                 [-8, 100, 0],
                 [-8, 0, 0],
                 [-292, 100, -7080.409858],
                 [-292, 100, 0],
                 [-292, 0, 7080.616479],
                 [-292, 0, 0],
                 [-292, 75, -3540.3],
                 [-292, 75, 0],
                 [-292, 25, 3540.3],
                 [-292, 25, 0],
                 [-292, 100, -7080.409858],
                 [-292, 0, 7080.616479],
                 [-292, 100, 0],
                 [-292, 0, 0]])

plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.serif'] = ['Times New Roman']

# 3d plot
fig = plt.figure(figsize=(12, 8))
ax = fig.add_subplot(111, projection='3d')
ax.set_box_aspect([3, 1, 0.8])

x = edge[:, 0]
y = edge[:, 1]
z = edge[:, 2]

ax.set_zlim(2 * min(z), 2 * max(z))
ax.plot(x, y, z, c='k', lw=1)

x = data[:, 0]
y = data[:, 1]
z = data[:, 2]

ax.scatter(x, y, z, c='k', marker='o', alpha=1)

x = sect[:, 0]
y = sect[:, 1]
z = sect[:, 2]
ax.plot(x, y, z, color=(0, 0, 0, 0.4), lw=1)

for i in range(12):
    ax.plot(line[i * 2:i * 2 + 2, 0],
            line[i * 2:i * 2 + 2, 1],
            line[i * 2:i * 2 + 2, 2], color=(0, 0, 0, 0.2), lw=1)

ax.grid(False)
ax.set_xlabel('Y (mm)', labelpad=30, fontsize=14)
ax.set_ylabel('Z (mm)', labelpad=5, fontsize=14)
ax.set_zlabel('Warping Function Ï‰ (mm)', labelpad=10, fontsize=14)

# Add labels to each point
ax.text(-8, 100, 12080.616479, "7080.5", fontsize=12, fontname='Times New Roman')
ax.text(0, -10, -12080.409858, "-7080.5", fontsize=12, fontname='Times New Roman')
ax.text(-272, 100, -12080.409858, "-7080.5", fontsize=12, fontname='Times New Roman')
ax.text(-292, -50, 12080.616479, "7080.5", fontsize=12, fontname='Times New Roman')

ax.text(-20, 45, 12080.616479, "3540.3", fontsize=12, fontname='Times New Roman')
ax.text(0, 25, -12080.409858, "-3540.3", fontsize=12, fontname='Times New Roman')
ax.text(-352, 100, -12080.409858, "-3540.3", fontsize=12, fontname='Times New Roman')
ax.text(-292, 0, 12080.616479, "3540.3", fontsize=12, fontname='Times New Roman')

ax.tick_params(axis='both', which='major', labelsize=12)

plt.show()
